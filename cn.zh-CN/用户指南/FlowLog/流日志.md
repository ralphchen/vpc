# 流日志 {#concept_ubn_5ly_52b .concept}

VPC提供流日志功能，可以记录VPC网络中弹性网卡（ENI）的传入和传出流量信息，帮助您检查访问控制规则、监控网络流量、进行网络故障排查。

## 功能介绍 {#section_cq5_rny_52b .section}

您可以捕获指定弹性网卡的流量，也可以指定一个VPC或交换机。如果选择为交换机或VPC创建流日志，则会捕获VPC和交换机中所有弹性网卡的流量，包括在开启流日志功能后新建的弹性网卡。

捕捉到的流量信息存储在阿里云日志服务中，您可以在日志服务中查看和分析相关数据。 流日志功能测试期间暂不收取费用，日志服务将收取相应的存储和检索费用，详情参见[计费方式](../../../../cn.zh-CN/产品定价/计费方式.md#)。

流日志功能捕获的流量信息会以流日志记录的方式写入日志服务。每个记录捕获特定捕获窗口中的特定5元组网络流。捕获窗口大约为10分钟。该段时间内流日志服务会聚合数据，大约需要5分钟，然后再发布流日志记录。

流日志记录的字段信息如下表所示。

|字段|说明|
|:-|:-|
|version|流日志版本。|
|account-id|账号ID。|
|eni-id|弹性网卡 ID。|
|srcaddr|源地址。|
|srcport|源端口。|
|dstaddr|目的地址。|
|dstport|目的端口。|
|protocol|流量的IANA协议编号。详细信息，参见[Internet 协议编号](http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml)。

|
|direction| 流量方向：-   in：入方向流量
-   out：出方向流量

|
|packets|数据包包数量|
|bytes|数据包大小。|
|start|捕捉窗口开始时间。|
|end|捕捉窗口结束时间。|
|log-status|流日志的日志记录状态：-    OK：数据记录正常
-    NODATA：捕获窗口中没有传入或传出网络接口的网络流量
-    SKIPDATA：捕获窗口中跳过了一些流日志记录

|
| action| 与流量关联的操作：-   ACCEPT：安全组允许记录的流量
-   REJECT：安全组未允许记录的流量

|

## 创建流日志 {#section_wyf_vtz_52b .section}

**说明：** 在创建流日志前，确保您已经开通了日志服务。

完成以下操作，创建流日志：

1.  登录[专有网络管理控制台](https://vpcnext.console.aliyun.com)。
2.  在左侧导航栏，单击**流日志**。
3.  如果您的账号账号是初次使用流日志功能，单击**同意授权**授权VPC可以向日志库中写数据。

    **说明：** 该操作只有主账号首次开通流日志功能时才需要。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17707/153916109311664_zh-CN.png)

4.  选择捕获日志资源的所属地域，然后单击**创建流日志**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17707/15391610939591_zh-CN.png)

5.  在创建流日志页面，根据以下信息完成配置，然后单击**确定**。

    |配置|说明|
    |:-|:-|
    |**名称**|输入流日志名称。|
    |**资源类型**|选择要捕获流量的资源类型：    -   弹性网卡：捕获指定的弹性网卡的流量信息。
    -   交换机：捕获指定的交换机内所有弹性网卡的流量信息。
    -   专有网络：捕获指定的专有网络内所有弹性网卡的流量信息。
|
    |**流量类型**|选择要捕获流量的类型：    -   全部流量：捕获指定资源的全部流量。
    -   被访问控制允许的流量：捕获指定资源被安全组规则允许的流量。
    -   被访问控制拒绝的流量：捕获指定资源被安全组规则拒绝的流量。
|
    |**LogStore**|选择存储写入数据的LogStore。|
    |**描述**|输入流日志的描述。|


## 查看日志 {#section_g5l_3f1_v2b .section}

完成以下操作，查看记录的日志数据：

1.  登录[专有网络管理控制台](https://vpcnext.console.aliyun.com)。
2.  在左侧导航栏，单击**流日志**。
3.  选择一个地域，然后单击存储目标流日志的日志库链接。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17707/153916109311665_zh-CN.png)

4.  在日志管理控制台，单击目标日志库的**查询**。
5.  查看日志分析数据。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17707/153916109411666_zh-CN.png)


## 停止流日志 {#section_wrx_s23_cfb .section}

 当暂时不需要某个流日志捕捉数据时，可以将其停止，再次需要时可以重新启动将已停止的流日志。

完成以下操作，查看记录的日志数据：

1.  登录[专有网络管理控制台](https://vpcnext.console.aliyun.com)。
2.  在左侧导航栏，单击**流日志**。
3.  选择一个地域，找到目标流日志，然后单击**停止**。

## 使用限制 {#section_eq4_pb5_cfb .section}

在使用流日志功能时，请注意：

-   流日志捕获流量的对象：弹性网卡（ENI）

-   支持创建流日志的资源类型：VPC、VSwitch和弹性网卡

-   每个地域可创建的流日志实例数量：10

    如果您需要创建更多流日志实例，提交工单申请。


